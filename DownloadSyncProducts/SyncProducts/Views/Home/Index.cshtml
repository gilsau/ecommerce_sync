@using SyncProducts.Models;
@using System.Data;
@model List<Website>
@{
    ViewBag.Title = "Manage Ecommerce Sites";
}

@section Scripts{
    <script type="text/javascript" src="~/Scripts/download.js"></script>
    <script type="text/javascript" src="~/Scripts/categories.js"></script>
    <script type="text/javascript" src="~/Scripts/products.js"></script>
}

<div data-ng-app="prodApp" data-ng-controller="productController" class="container-fluid">
    <strong class="error">{{ error }}</strong>
    <div id="mydiv" data-ng-show="loading">
        <img src="~/Images/ajax-loader.gif" style="width:200px;" class="ajax-loader" />
    </div>

    <ul class="nav nav-tabs">
        <li><a data-toggle="tab" href="#tab1">DOWNLOAD</a></li>
        <li class="active"><a data-toggle="tab" href="#tab2">CATEGORIES</a></li>
        <li ><a data-toggle="tab" href="#tab3">PRODUCTS</a></li>
    </ul>
    <div class="tab-content">
        <div id="tab1" class="tab-pane fade">
            <h3>DOWNLOAD</h3>

            <div class="row">
                <div class="col-sm-8">
                    <div id="downloadTop" style="overflow:scroll;">
                        <table class="table table-striped" style="width:100%;">
                            <tr>
                                <th>Company</th>
                                <th>Products Url</th>
                                <th>Images Url</th>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-ahi.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=B365&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/B365/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-air-venturi.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=P892&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/P892/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-allinaudio.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=W290&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/W290/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-azuregreen.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=H558&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/H558/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-bangalla.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=G240&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/G240/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-bedinabag.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=Z591&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/Z591/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo_brybelly.png" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=K940&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/K940/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-buy2bee.png" /><br />w/VARIANT</td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=U675&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/U675/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo-buy2bee.png" /><br />buy2bee.com</td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=D205&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/D205/split/all_large.zip</td>
                            </tr>
                            <tr>
                                <td class="logoTD"><img src="https://www.wholesale2b.com/logo/logo_posterart.jpg" /></td>
                                <td class="prodUrlTD">https://www.wholesale2b.com/members.php/myaccount/download?download=data&id=&supplier_id=S949&feed_type=free&feed=1&zip=1&token=1b6a9869369ae9eb8f83ea843edb3b2c</td>
                                <td class="imgUrlTD">http://www.imageserverhost.com/img/S949/split/all_large.zip</td>
                            </tr>
                        </table>
                    </div>
                    <span id="spanDwnFiles" class="form-control btn btn-primary btn-lg">Download Files From Supplier Urls</span>
                    <div id="spanDwnFilesProg" class="progBar">0%</div>
                </div>
                <div class="col-sm-4">
                    <div id="pnlLogTop" class="panel panel-default">
                        <div class="panel-heading">LOG FILE</div>
                        <div id="pnlDwn1" class="panel-body" style="word-wrap:break-word;overflow:auto;"></div>
                    </div>
                </div>
            </div>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <div class="row">
                <div class="col-sm-8">
                    <div id="downloadBottom" class="panel panel-default" style="overflow:scroll;margin:0px;">
                        <div class="panel-heading" style="font-weight:bold;">Files Downloaded</div>
                        <div id="pnlFileDownloads" class="panel-body">

                        </div>
                    </div>
                    <span id="spanSaveFiles" class="form-control btn btn-primary btn-lg">Save Products In Files To Local Database</span>
                    <div id="spanSaveFilesProg" class="progBar">0%</div>
                </div>
                <div class="col-sm-4">
                    <div id="pnlLogBottom" class="panel panel-default">
                        <div class="panel-heading">LOG FILE</div>
                        <div id="pnlDwn2" class="panel-body" style="word-wrap:break-word;overflow:auto;"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="tab2" class="tab-pane fade in active">
            <h3>CATEGORIES</h3>
            <div class="container-fluid nopad nomarg">
                <div class="row-fluid nopad nomarg">
                    <div class="col-md-10 nopad nomarg">
                        <div id="pnlCats" class="panel panel-default">
                            <div class="panel-heading nopad nomarg" style="overflow-y:scroll;overflow-x:hidden;">
                                <div class="row">
                                    <div class="col-md-1">&nbsp;</div>
                                    <div class="col-md-5 text-danger">WEBSITE MEMBERSHIPS</div>
                                    <div class="col-md-6 text-danger">LOCAL DATABASE CATEGORIES</div>
                                </div>
                                <table class="table table-bordered nopad nomarg">
                                    <tr>
                                        <th class="cathead head1" style="width:5%;">#</th>
                                        @foreach (Website web in Model)
                                        {
                                            <th class="cathead text-center head1" style="width:5%;" title="@web.Name">
                                                <a target="_blank" href="@web.Url">@web.Abbrev</a>
                                                <div><span class="megaChkAll glyphicon glyphicon-check btn" data-web-id="@web.Id" /></div>
                                                <div><span class="megaChkNone glyphicon glyphicon-unchecked btn" data-web-id="@web.Id" /></div>
                                            </th>
                                        }
                                        <th class="cathead text-left head1" style="width:20%;">Cat1</th>
                                        <th class="cathead text-left head1" style="width:20%;">Cat2</th>
                                        <th class="cathead text-left head1" style="width:20%;">Cat3</th>
                                        <th class="cathead text-center head1" style="width:10%;">Prods</th>
                                    </tr>
                                </table>
                            </div>
                            <div class="panel-body nopad nomarg scroll" style="overflow:scroll;">
                                <table id="catTable" class="table table-striped table-bordered nopad nomarg">
                                    <tr class="catrow" data-ng-repeat="cat in categories">
                                        <th class="head1Big" style="width:5%;vertical-align:middle;">{{ cat.RowNum }}</th>
                                        <th class="text-center" style="width:5%;" data-ng-repeat="webMembership in cat.WebMemberships">
                                            <input class="bigCheck chk-{{ webMembership.WebId }}" type="checkbox" data-web-id="{{ webMembership.WebId }}" data-categories="{{ webMembership.Category1 + '|' + webMembership.Category2 + '|' + webMembership.Category3 }}" ng-checked="webMembership.IsMember" />
                                            <div style="font-size:10px;"><a target="_blank" href="{{ webMembership.ProductsUrl }}">{{ webMembership.ProductCount }}</a></div>
                                        </th>
                                        <th class="va-middle" style="width:20%;">{{ cat.Category1 }}</th>
                                        <th class="va-middle" style="width:20%;">{{ cat.Category2 }}</th>
                                        <th class="va-middle" style="width:20%;">{{ cat.Category3 }}</th>
                                        <th class="text-center va-middle" style="width:10%;"><span class="btn btn-sm btn-primary" style="width:50px;" ng-click="showProducts(cat)">{{ cat.ProductCount }}</span></th>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <span class="form-control btn btn-primary btn-sm">DOWNLOAD WEB MEMBERSHIPS</span>
                        <p>&nbsp;</p>
                        <span ng-click="updateWebMemsAndProdCounts()" class="form-control btn btn-primary btn-sm">UPD WEB MEMS & PROD CNTS</span>
                        <p>&nbsp;</p>
                        <div class="panel panel-default">
                            <div class="panel-heading">LOG FILE</div>
                            <div id="pnl2" class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="tab3" class="tab-pane fade in">
            <h3>PRODUCTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <select id="selCategories" ng-model="cat" ng-change="getProducts(cat)" ng-options='cat as (cat.Category1 + " - " + cat.Category2 + " - " + cat.Category3) for cat in categories'></select>
            </h3>
            <div class="container-fluid nopad nomarg">
                <div class="row-fluid nopad nomarg">
                    <div class="col-md-10 nopad nomarg">
                        <div id="pnlProds" class="panel panel-default">
                            <div class="panel-heading nopad nomarg" style="overflow-y:scroll;overflow-x:hidden;">
                                <div class="row">
                                    <div class="col-md-1">&nbsp;</div>
                                    <div class="col-md-5 text-danger">WEBSITE MEMBERSHIPS</div>
                                    <div class="col-md-6 text-danger">LOCAL DATABASE PRODUCTS</div>
                                </div>
                                <table class="table table-bordered nopad nomarg">
                                    <tr>
                                        <th class="prodhead head1" style="width:5%;">#</th>
                                        @foreach (Website web in Model)
                                        {
                                            <th class="prodhead text-center head1" style="width:5%;" title="@web.Name">
                                                <span class="glyphicon glyphicon-unchecked btn"></span>
                                                <a target="_blank" href="@web.Url">@web.Abbrev</a>
                                            </th>
                                        }
                                        <th class="prodhead text-center head1" style="width:10%;">IMG</th>
                                        <th class="prodhead text-left head1" style="width:30%;">Name</th>
                                        <th class="prodhead text-right head1" style="width:10%;">Wholesale</th>
                                        <th class="prodhead text-right head1" style="width:10%;">Retail</th>
                                        <th class="prodhead text-right head1" style="width:10%;">In Stock</th>
                                    </tr>
                                </table>
                            </div>
                            <div class="panel-body nopad nomarg scroll" style="overflow:scroll;">
                                <table id="prodTable" class="table table-striped table-bordered nopad nomarg">
                                    <tr class="prodrow" data-ng-repeat="prod in products">
                                        <th class="head1Big" style="width:5%;vertical-align:middle;">{{ prod.RowNum }}</th>
                                        <th class="text-center" style="width:5%;"><input class="bigCheck" type="checkbox" /></th>
                                        <th class="text-center" style="width:5%;"><input class="bigCheck" type="checkbox" /></th>
                                        <th class="text-center" style="width:5%;"><input class="bigCheck" type="checkbox" /></th>
                                        <th class="text-center" style="width:5%;"><input class="bigCheck" type="checkbox" /></th>
                                        <th class="text-center" style="width:5%;"><input class="bigCheck" type="checkbox" /></th>
                                        <th class="text-center va-middle" style="width:10%;"><a target="_blank" href="{{ prod.URLToLargeImage }}"><img src="{{ prod.URLToThumbImage }}" style="height:50px;" /></a></th>
                                        <th class="text-left va-middle" style="width:30%;">{{ prod.ProductName }}</th>
                                        <th class="text-right va-middle" style="width:10%;">{{ prod.WholesalePriceBeforeMarkup|currency }}</th>
                                        <th class="text-right va-middle" style="width:10%;">{{ prod.RetailPrice|currency }}</th>
                                        <th class="text-right va-middle" style="width:10%;">{{ prod.QtyInStock }}</th>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <span class="form-control btn btn-primary btn-sm">DOWNLOAD WEB MEMS</span>
                        <p>&nbsp;</p>
                        <span class="form-control btn btn-primary btn-sm">UPD WEB MEMS & PROD CNTS</span>
                        <p>&nbsp;</p>
                        <div class="panel panel-default">
                            <div class="panel-heading">LOG FILE</div>
                            <div class="panel-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>